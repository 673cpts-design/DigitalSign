<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>CSV Vertical Marquee</title>
  <style>
    body {
      background: white;
      color: black;
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 0;
      overflow: hidden;
      position: relative;
      height: 100vh;
    }
    #marquee-container {
      position: absolute;
      top: 0px;
      left: 0px;
      width: auto;
      height: calc(1.2em * 8); /* 8 lines */
      overflow: hidden;
    }
    #marquee {
      font-size: 1.7em;
      font-weight: bold;
      line-height: 1.2em;
      display: inline-block;
      white-space: nowrap;
      animation: scrollUp linear infinite;
    }
    @keyframes scrollUp {
      0% { transform: translateY(0); }
      100% { transform: translateY(-100%); }
    }
    span.email {
      color: blue;
    }
  </style>
</head>
<body>

<div id="marquee-container">
  <div id="marquee">Loading...</div>
</div>

<script>
const rows = [
["B", "SSgt", "Rhiannan.Flora@us.af.mil", "552-0176"],
["B", "SSgt", "Skyler.Tutt@us.af.mil", "552-7070"],
["F1", "SSgt", "Chance.Lawson@us.af.mil", "552-4893"],
["F1", "SSgt", "Austin.Young.5@us.af.mil", "552-2158"],
["F1", "TSgt", "Cristi.Cruz@us.af.mil", "551-4820"],
["F2", "Civ", "Jaycee.Jones@us.af.mil", "552-6605"],
["F2", "Civ", "Frarene.Deaton@us.af.mil", "552-2102"],
["F3", "SSgt", "Shayna.Teunissen@us.af.mil", "552-9734"],
["F3", "Civ", "Rebecca.Hudson.1@us.af.mil", "552-0525"],
["F3", "SSgt", "Mallory.Legear@us.af.mil", "552-3043"]
];

function highlightEmails(text) {
    return text.replace(/([a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,})/g, '<span class="email">$&</span>');
}

function startMarquee() {
  const marquee = document.getElementById('marquee');
  if (rows.length === 0) {
    marquee.innerText = "No data.";
    return;
  }

  const allLines = rows.map(r => r.join('   '));
  const htmlLines = allLines.map(line => highlightEmails(line));

  const spacedLines = [];
  htmlLines.forEach(l => {
    spacedLines.push(l);
    spacedLines.push("&nbsp;");
  });

  marquee.innerHTML = spacedLines.join("<br>") + "<br>" + spacedLines.join("<br>");

  const duration = spacedLines.length * 4; // slower scroll
  marquee.style.animationDuration = duration + "s";
}

window.onload = startMarquee;
</script>

</body>
</html>
